same code implementing by spark
